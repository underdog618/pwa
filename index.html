<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
    </head>
    <body>
        <div class="enable-notifications" style="border-radius: 50px; width: 100px; height: 30px; background-color: aquamarine; text-align: center; line-height: 30px; color: brown; font-weight: bold; cursor: pointer; display: none">訂閱</div>
    </body>
    <script>
        var enableNotifications = document.querySelectorAll(".enable-notifications");

        if ("Notification" in window) {
            for (var i = 0; i < enableNotifications.length; i++) {
                enableNotifications[i].style.display = "inline-block";
                enableNotifications[i].addEventListener("click", askForNotificationPermission);
            }
        }

        function askForNotificationPermission() {
            Notification.requestPermission(function (status) {
                console.log("User Choice", status);
                if (status !== "granted") {
                    console.log("推播允許被拒絕了!");
                } else {
                    displayNotification();
                }
            });
        }

        function displayNotification() {
                     console.log(123);
            if ("serviceWorker" in navigator) {
                         console.log(123);
                var options = {
                    body: "歡迎進入30天PWA的世界",
                };
                navigator.serviceWorker.ready.then(function (sw) {
                    sw.showNotification("訂閱成功！！！", options);
                });
            }
        }
    </script>
</html>
